#!/usr/bin/env ruby
require "fileutils"
require "trails"

def make_file(name, &block)
  File.open("#{@name}/#{name}", "w") do |file|
    block.call(file)
  end
end

case ARGV[0]
when "new"
  @name, @options = ARGV[1], ARGV[2..-1]
  @app_name = @name.capitalize
  Dir.mkdir(@name)
  Dir.mkdir([@name, "config"].join("/"))
  Dir.mkdir([@name, "config", "environments"].join("/"))
  
  %w(production test development).each do |filename|
    make_file("config/environmennts/#{filename}.rb") do |file|
      file.write <<HEREDOC
# 
HEREDOC
    end
  end
  
  make_file("config.ru") do |file|
    file.write <<HEREDOC
require './config/application'
run #{@app_name}.new

HEREDOC
  end
  
  make_file("config/application.rb") do |file|
    file.write  <<HEREDOC
require 'trails'

class #{@app_name} < Trails::App
  # Your code here
end
HEREDOC

  end

  make_file("Gemfile") do |file|
    file.write <<HEREDOC
source 'https://rubygems.org'

gem "trails", "#{Trails::VERSION}"
HEREDOC
  end
  
end

